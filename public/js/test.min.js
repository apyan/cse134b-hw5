function writeNewUserData(a,b){firebase.database().ref().child("users/"+b).set({customList:{"0-Custom":{DateRelease:0,Description:!1,Exclusive:!1,GameOrigin:!1,Image:!1,Name:!1,Number:!1,Rarity:!1,Wave:!1,Owned:!1}},password:a,authenticationId:b,originalList:{Mario:!1,Peach:!1,Yoshi:!1,DonkeyKong:!1,Link:!1,Fox:!1,Samus:!1,WiiFitTrainer:!1,Villager:!1,Pikachu:!1,Kirby:!1,Marth:!1,Zelda:!1,DiddyKong:!1,Luigi:!1,LittleMac:!1,Pit:!1,CaptainFalcon:!1,"Rosalina&Luma":!1,Bowser:!1,Lucario:!1,ToonLink:!1,Sheik:!1,Ike:!1,Shulk:!1,Sonic:!1,MegaMan:!1,KingDedede:!1,MetaKnight:!1,Robin:!1,Lucina:!1,Wario:!1,Charizard:!1,Ness:!1}})}function updateOwnership(a,b){var d,c=firebase.database().ref().child("users").child(b).child("originalList").child(a);c.on("value",function(a){d=a.val()});var e={};e["/users/"+b+"/originalList/"+a]=!d,document.getElementById(a+"-Checked").checked=!d,firebase.database().ref().update(e)}function waitToFinishCustom(a,b){if(null==valueCustom)return void setTimeout(function(){waitToFinishCustom(a,b)},50);var c={};c["/users/"+b+"/customList/"+a+"/Have"]=!valueCustom,firebase.database().ref().update(c),valueCustom=null}function updateOwnershipCustom(a,b){var c=firebase.database().ref().child("users").child(b).child("customList").child(a).child("Have");valueCustom=null,c.on("value",function(a){valueCustom=a.val()}),waitToFinishCustom(a,b)}function fastForEachFunction(a,b){var c=a.split("-"),e=(c[0],c[1]),f=document.getElementById(e+"-NumberFast"),g=firebaseFastAmiiboListRef.child(a);g.child("Number").on("value",function(a){f.innerHTML=a.val()});var h=document.getElementById(e+"-NameFast");g.child("Name").on("value",function(a){h.innerHTML=a.val()});var i=document.getElementById(e+"-ImageFast");g.child("Image").on("value",function(a){i.src=a.val(),i.onload=function(a){fastNumberOfAmiibo+=1}});var j=document.getElementById(e+"-GameOriginFast");g.child("Game Origin").on("value",function(a){j.innerHTML=a.val()});var k=document.getElementById(e+"-DateReleaseFast");g.child("Date Release").on("value",function(a){k.innerHTML=a.val()});var l=document.getElementById(e+"-WaveFast");g.child("Wave").on("value",function(a){l.innerHTML=a.val()});var m=document.getElementById(e+"-ExclusiveFast");g.child("Exclusive").on("value",function(a){m.innerHTML=a.val()});var n=document.getElementById(e+"-DescriptionFast");g.child("Description").on("value",function(a){n.innerHTML=a.val()});var o=document.getElementById(e+"-RarityFast");g.child("Rarity").on("value",function(a){o.innerHTML=a.val()})}function forEachFunction(a,b){var c=a.split("-"),e=(c[0],c[1]),f=document.getElementById(e+"-Number"),g=firebaseAmiiboListRef.child(a);g.child("Number").on("value",function(a){f.innerHTML=a.val()});var h=document.getElementById(e+"-Name");g.child("Name").on("value",function(a){h.innerHTML=a.val()});var i=document.getElementById(e+"-Image");g.child("Image").on("value",function(a){i.src=a.val(),i.onload=function(a){numberOfAmiibo+=1}});var j=document.getElementById(e+"-GameOrigin");g.child("Game Origin").on("value",function(a){j.innerHTML=a.val()});var k=document.getElementById(e+"-DateRelease");g.child("Date Release").on("value",function(a){k.innerHTML=a.val()});var l=document.getElementById(e+"-Wave");g.child("Wave").on("value",function(a){l.innerHTML=a.val()});var m=document.getElementById(e+"-Exclusive");g.child("Exclusive").on("value",function(a){m.innerHTML=a.val()});var n=document.getElementById(e+"-Description");g.child("Description").on("value",function(a){n.innerHTML=a.val()});var o=document.getElementById(e+"-Rarity");g.child("Rarity").on("value",function(a){o.innerHTML=a.val()})}function waitToFinish4(){return 0==customAmiiboList.length&&customAmiiboList.length==currentCustomAmiiboListNumber?void setTimeout(waitToFinish4,50):0!=customAmiiboList.length&&customAmiiboList.length!=currentCustomAmiiboListNumber?void setTimeout(waitToFinish4,50):(customAmiiboTable.style.display="block",void $("#customAmiiboTable").DataTable())}function waitToFinish3(){if(34!=numberOfAmiibo)return void setTimeout(waitToFinish3,50);$("#fastTable").hide();var a=document.getElementById("progress");a.style.display="none",mainTable.style.display="block",$("#mainTable").DataTable()}function waitToFinish2(){if(10!=fastNumberOfAmiibo){var a=document.getElementById("bar");return a.innerHTML=10*fastNumberOfAmiibo+"%",a.style.width=10*fastNumberOfAmiibo+"%",void setTimeout(waitToFinish2,50)}var a=document.getElementById("progress");a.style.display="none",$("#fastTable").DataTable({paging:!1,searching:!1,info:!1}),$("#fastTable").show()}function markOwnership(a,b,c){if("SkipThis"!==a){var d=a.split("-"),e=document.getElementById(d[1]+"-Checked"),f=firebase.database().ref().child("users").child(c).child("originalList").child(d[1]);f.on("value",function(a){e.checked=a.val()})}}function markOwnershipCustom(a,b,c){if("SkipThis"!==a){var d=document.getElementById(a+"-Checked"),e=firebase.database().ref().child("users").child(c).child("originalList").child(a);e.on("value",function(a){d.checked=a.val()})}}function waitReturnToIndex(){return 1!=backToIndex?void setTimeout(waitReturnToIndex,50):void(window.location.href="indexsignedin.html")}function waitForURL(){return null===downloadURL?void setTimeout(waitForURL,50):void firebase.database().ref().child("users/"+authId+"/customList/"+number+"-"+name).set({DateRelease:date,Description:description,Exclusive:exclusive,GameOrigin:origin,Image:downloadURL,Name:name,Number:number,Rarity:rarity,Wave:wave,Have:have}).then(function(a){backToIndex=1,waitReturnToIndex()})}function waitToUpload(){return 1!=uploaded?void setTimeout(waitToUpload,50):(pictureCustomRef.getDownloadURL().then(function(a){downloadURL=a}),void waitForURL())}function addAmiibo(a){showLoadingModal();var b,c=document.getElementById("image");if("files"in c&&(b=c.files[0]),null==b)downloadURL="file://null",number=document.getElementById("number").value,name=document.getElementById("name").value,origin=document.getElementById("origin").value,date=document.getElementById("date").value,wave=document.getElementById("wave").value,exclusive=document.getElementById("exclusive").value,description=document.getElementById("description").value,rarity=document.getElementById("rarity").value,have=document.getElementById("have").checked,waitForURL();else{var d=firebase.storage().ref(),e=d.child(b.name),f=new Date;pictureTime=f.getTime(),pictureCustomRef=d.child("Custom-Amiibo/"+a+"/"+b.name+"-"+pictureTime),e.name===pictureCustomRef.name,e.fullPath===pictureCustomRef.fullPath,uploaded=0,pictureCustomRef.put(b).then(function(a){uploaded=1}),downloadURL=null,waitToUpload(),number=document.getElementById("number").value,name=document.getElementById("name").value,origin=document.getElementById("origin").value,date=document.getElementById("date").value,wave=document.getElementById("wave").value,exclusive=document.getElementById("exclusive").value,description=document.getElementById("description").value,rarity=document.getElementById("rarity").value,have=document.getElementById("have").checked}}function displayCustomEdit(a){for(var b in a)if("0-Custom"!==b){var c=document.createElement("TR"),d=document.createElement("TD"),e=document.createElement("input");e.type="text",e.id=a[b].Name+"-Number",e.value=a[b].Number,d.appendChild(e),c.appendChild(d);var f=document.createElement("TD"),g=document.createElement("input");g.type="text",g.id=a[b].Name+"-Name",g.value=a[b].Name,f.appendChild(g),c.appendChild(f);var h=document.createElement("TD"),i=document.createElement("img");i.src=a[b].Image,i.class="amiiboImg",i.id=a[b].Name+"-Image",i.style.width="100%",h.appendChild(i);var j=document.createElement("input");j.type="file",j.accept="image/*",j.id=a[b].Name+"-NewImage",h.appendChild(j),c.appendChild(h);var k=document.createElement("TD"),l=document.createElement("input");l.type="text",l.id=a[b].Name+"-GameOrigin",l.value=a[b].GameOrigin,k.appendChild(l),c.appendChild(k);var m=document.createElement("TD"),n=document.createElement("input");n.type="text",n.id=a[b].Name+"-DateRelease",n.value=a[b].DateRelease,m.appendChild(n),c.appendChild(m);var o=document.createElement("TD"),p=document.createElement("input");p.type="text",p.id=a[b].Name+"-Wave",p.value=a[b].Wave,o.appendChild(p),c.appendChild(o);var q=document.createElement("TD"),r=document.createElement("input");r.type="text",r.id=a[b].Name+"-Exclusive",r.value=a[b].Exclusive,q.appendChild(r),c.appendChild(q);var s=document.createElement("TD"),t=document.createElement("input");t.type="text",t.id=a[b].Name+"-Description",t.value=a[b].Description,s.appendChild(t),c.appendChild(s);var u=document.createElement("TD"),v=document.createElement("input");v.type="text",v.id=a[b].Name+"-Rarity",v.value=a[b].Rarity,u.appendChild(v),c.appendChild(u);var w=document.createElement("TD"),x=document.createElement("input");x.type="checkbox",x.id=a[b].Name+"-Have",x.checked=a[b].Have,w.appendChild(x),c.appendChild(w),document.getElementById("customAmiiboTableEdit").appendChild(c)}}function displayCustomAmiibo(a){for(var b in a)if("0-Custom"!==b){customAmiiboList.push(a[b].Number);var c=document.createElement("TR"),d=document.createElement("TD"),e=document.createTextNode(a[b].Number);d.appendChild(e),c.appendChild(d);var f=document.createElement("TD"),g=document.createTextNode(a[b].Name);f.appendChild(g),c.appendChild(f);var h=document.createElement("TD"),i=document.createElement("img");i.src=a[b].Image,i.class="amiiboImg",i.id="picture",i.style.width="100%",h.appendChild(i),c.appendChild(h);var j=document.createElement("TD"),k=document.createTextNode(a[b].GameOrigin);j.appendChild(k),c.appendChild(j);var l=document.createElement("TD"),m=document.createTextNode(a[b].DateRelease);l.appendChild(m),c.appendChild(l);var n=document.createElement("TD"),o=document.createTextNode(a[b].Wave);n.appendChild(o),c.appendChild(n);var p=document.createElement("TD"),q=document.createTextNode(a[b].Exclusive);p.appendChild(q),c.appendChild(p);var r=document.createElement("TD"),s=document.createTextNode(a[b].Description);r.appendChild(s),c.appendChild(r);var t=document.createElement("TD"),u=document.createTextNode(a[b].Rarity);t.appendChild(u),c.appendChild(t);var v=document.createElement("TD"),w=document.createElement("input");w.type="checkbox",w.class=a[b].Number+"-"+a[b].Name,w.id=a[b].Name+"-Checked",w.checked=a[b].Have,w.onclick=function(){updateOwnershipCustom(this.class,authId)},v.appendChild(w),c.appendChild(v),document.getElementById("customAmiiboTable").appendChild(c),currentCustomAmiiboListNumber+=1}}function waitForURLEdit(){return null===downloadURL?void setTimeout(waitForURLEdit,50):void firebase.database().ref().child("users/"+authId+"/customList/"+number+"-"+name).set({DateRelease:date,Description:description,Exclusive:exclusive,GameOrigin:origin,Image:downloadURL,Name:name,Number:number,Rarity:rarity,Wave:wave,Have:have})}function waitToUploadEdit(){return 1!=uploaded?void setTimeout(waitToUploadEdit,50):(pictureCustomRef.getDownloadURL().then(function(a){downloadURL=a}),void waitForURLEdit())}function countCustom(a){for(var b in a)customCounter++}function editAmiibo(a){for(var b in a)if("0-Custom"!==b){downloadURL=null;var c,d=document.getElementById(a[b].Name+"-NewImage"),e=document.getElementById(a[b].Name+"-Image");if("files"in d&&(c=d.files[0]),null==c){var f=firebase.database().ref().child("users").child(authId).child("customList").child(a[b].Number+"-"+a[b].Name);f.remove(),downloadURL=e.src,number=document.getElementById(a[b].Name+"-Number").value,name=document.getElementById(a[b].Name+"-Name").value,origin=document.getElementById(a[b].Name+"-GameOrigin").value,date=document.getElementById(a[b].Name+"-DateRelease").value,wave=document.getElementById(a[b].Name+"-Wave").value,exclusive=document.getElementById(a[b].Name+"-Exclusive").value,description=document.getElementById(a[b].Name+"-Description").value,rarity=document.getElementById(a[b].Name+"-Rarity").value,have=document.getElementById(a[b].Name+"-Have").checked,waitForURLEdit()}else{var g=firebase.storage().ref(),h=g.child(c.name),i=new Date;pictureTime=i.getTime(),pictureCustomRef=g.child("Custom-Amiibo/"+authId+"/"+c.name+"-"+pictureTime),h.name===pictureCustomRef.name,h.fullPath===pictureCustomRef.fullPath,uploaded=0,pictureCustomRef.put(c).then(function(a){uploaded=1}),number=document.getElementById(a[b].Name+"-Number").value,name=document.getElementById(a[b].Name+"-Name").value,origin=document.getElementById(a[b].Name+"-GameOrigin").value,date=document.getElementById(a[b].Name+"-DateRelease").value,wave=document.getElementById(a[b].Name+"-Wave").value,exclusive=document.getElementById(a[b].Name+"-Exclusive").value,description=document.getElementById(a[b].Name+"-Description").value,rarity=document.getElementById(a[b].Name+"-Rarity").value,have=document.getElementById(a[b].Name+"-Have").checked,waitToUploadEdit();var f=firebase.database().ref().child("users").child(authId).child("customList").child(a[b].Number+"-"+a[b].Name);f.remove(),customSoFar++}}customCounter===customSoFar&&(window.location.href="indexsignedin.html")}function editAmiiboClick(){firebaseCustomRef=firebase.database().ref().child("users").child(authId).child("customList"),firebaseCustomRef.once("value",function(a){countCustom(a.val())}),firebaseCustomRef.once("value",function(a){editAmiibo(a.val())})}function checkDelete(){firebaseCustomRef=firebase.database().ref().child("users").child(authId).child("customList"),firebaseCustomRef.once("value",function(a){customObject(a.val())})}function customObject(a){for(var b in a)if("0-Custom"!==b){var c=document.getElementById(a[b].Name+"-Remove");if(c.checked){var d=firebase.database().ref().child("users").child(authId).child("customList").child(a[b].Number+"-"+a[b].Name);d.remove(),location.reload()}}}function printObject(a){for(var b in a)if("0-Custom"!==b){var c=document.createElement("TR"),d=document.createElement("TD"),e=document.createElement("input");e.type="checkbox",e.id=a[b].Name+"-Remove",e.checked=!1,d.appendChild(e),c.appendChild(d);var f=document.createElement("TD"),g=document.createTextNode(a[b].Number);f.appendChild(g),c.appendChild(f);var h=document.createElement("TD"),i=document.createTextNode(a[b].Name);h.appendChild(i),c.appendChild(h);var j=document.createElement("TD"),k=document.createElement("img");k.src=a[b].Image,k.class="amiiboImg",k.id="picture",k.style.width="100%",j.appendChild(k),c.appendChild(j);var l=document.createElement("TD"),m=document.createTextNode(a[b].GameOrigin);l.appendChild(m),c.appendChild(l);var n=document.createElement("TD"),o=document.createTextNode(a[b].DateRelease);n.appendChild(o),c.appendChild(n);var p=document.createElement("TD"),q=document.createTextNode(a[b].Wave);p.appendChild(q),c.appendChild(p);var r=document.createElement("TD"),s=document.createTextNode(a[b].Exclusive);r.appendChild(s),c.appendChild(r);var t=document.createElement("TD"),u=document.createTextNode(a[b].Description);t.appendChild(u),c.appendChild(t);var v=document.createElement("TD"),w=document.createTextNode(a[b].Rarity);v.appendChild(w),c.appendChild(v);var x=document.createElement("TD"),y=document.createElement("input");y.type="checkbox",y.id=a[b].Name+"-Checked",y.checked=a[b].Have,y.disabled=!0,x.appendChild(y),c.appendChild(x),document.getElementById("customAmiiboTable").appendChild(c)}}function signUpUserData(){var a=document.querySelector("#password").value,b=document.querySelector("#repassword").value,c=document.querySelector("#email").value;0==a.localeCompare(b)?(firebase.auth().createUserWithEmailAndPassword(c,a).catch(function(a){a.code,a.message;document.getElementById("sign-up-status").innerHTML="Error: "+a.message}),firebase.auth().onAuthStateChanged(function(b){b&&(writeNewUserData(a,b.uid),window.location.href="indexsignedin.html")})):document.getElementById("sign-up-status").innerHTML="Error: The two passwords must match."}function signInUserData(){var a=document.querySelector("#email").value,b=document.querySelector("#password").value;firebase.auth().signInWithEmailAndPassword(a,b).catch(function(a){console.log(a.code),console.log(a.message),document.getElementById("sign-in-status").innerHTML="Error: "+a.message}),firebase.auth().onAuthStateChanged(function(a){a&&(window.location.href="indexsignedin.html")})}function google_login_in(){var a=new firebase.auth.GoogleAuthProvider;a.addScope("https://www.googleapis.com/auth/plus.login"),firebase.auth().signInWithPopup(a).then(function(a){a.credential.accessToken,a.user;window.location.href="indexsignedin.html"}).catch(function(a){a.code,a.message,a.email,a.credential})}function signOutUserData(){firebase.auth().signOut().then(function(){},function(a){alert(a.code),alert(a.message)}),window.location.href="index.html"}function backPressed(){firebase.auth().onAuthStateChanged(function(a){0==page.localeCompare("add.html")&&a&&(window.location.href="indexsignedin.html"),0==page.localeCompare("delete.html")&&a&&(window.location.href="indexsignedin.html"),0==page.localeCompare("indexdelete.html")&&a&&(window.location.href="indexsignedin.html"),0==page.localeCompare("indexedit.html")&&a&&(window.location.href="indexsignedin.html")})}function showLoadingModal(){loadingModal.style.display="block"}function showSignInModal(){signInModal.style.display="block"}function closeSignInModal(){signInModal.style.display="none"}function showSignUpModal(){signUpModal.style.display="block"}function closeSignUpModal(){signUpModal.style.display="none"}function showSignOutModal(){signOutModal.style.display="block"}function closeSignOutModal(){signOutModal.style.display="none"}function showAddModal(){addModal.style.display="block"}function closeAddModal(){addModal.style.display="none"}var config={apiKey:"AIzaSyC4kvaSISiSc-t_3Grn4r4lQ0ibVfefy3Y",authDomain:"amiibodex2.firebaseapp.com",databaseURL:"https://amiibodex2.firebaseio.com",storageBucket:"amiibodex2.appspot.com",messagingSenderId:"282900010964"};firebase.initializeApp(config);var path1=window.location.pathname,page1=path1.split("/").pop();0!=page1.localeCompare("index.html")&&0!=page1.localeCompare("")||window.addEventListener("load",function(){navigator.serviceWorker.register("service-worker.js",{scope:"./"}).then(function(a){console.log("registered service worker")}).catch(function(a){console.error("uh oh... "),console.error(a)}),window.addEventListener("beforeinstallprompt",function(a){})});var path=window.location.pathname,page=path.split("/").pop(),authId,firebaseCustomRef,customAmiiboListNumber=0,currentCustomAmiiboListNumber=0,customAmiiboList=[],firebaseAmiiboListRef=firebase.database().ref().child("original-amiibo-list"),firebaseFastAmiiboListRef=firebase.database().ref().child("fast-amiibo-list"),characters=["1-Mario","2-Peach","3-Yoshi","4-DonkeyKong","5-Link","6-Fox","7-Samus","8-WiiFitTrainer","9-Villager","10-Pikachu","11-Kirby","12-Marth","13-Zelda","14-DiddyKong","15-Luigi","16-LittleMac","17-Pit","18-CaptainFalcon","19-Rosalina&Luma","20-Bowser","21-Lucario","22-ToonLink","23-Sheik","24-Ike","25-Shulk","26-Sonic","27-MegaMan","28-KingDedede","29-MetaKnight","30-Robin","31-Lucina","32-Wario","33-Charizard","34-Ness"],fastcharacters1=["1-Mario","2-Peach","3-Yoshi","4-DonkeyKong","5-Link","6-Fox","7-Samus","8-WiiFitTrainer","9-Villager","10-Pikachu"];firebase.auth().onAuthStateChanged(function(a){if(0==page.localeCompare("index.html")||0==page.localeCompare(""))a&&(window.location.href="indexsignedin.html");else if(0==page.localeCompare("indexdelete.html"))a?(document.getElementById("greeting-line").innerHTML="Welcome, "+a.email+"!",authId=a.uid,b=firebase.database().ref().child("users").child(authId).child("customList"),b.once("value",function(a){printObject(a.val())}),customAmiiboTable.style.display="block"):window.location.href="index.html";else if(0==page.localeCompare("indexedit.html"))if(a){authId=a.uid,document.getElementById("greeting-line").innerHTML="Welcome, "+a.email+"!";var b=firebase.database().ref().child("users").child(authId).child("customList");b.once("value",function(a){displayCustomEdit(a.val())}),customAmiiboTableEdit.style.display="block"}else window.location.href="index.html";else if(0==page.localeCompare("indexsignedin.html"))if(a){document.getElementById("greeting-line").innerHTML="Welcome, "+a.email+"!",authId=a.uid;var b=firebase.database().ref().child("users").child(authId).child("customList");characters.forEach(function(a,b){markOwnership(a,b,authId)}),b.once("value",function(a){displayCustomAmiibo(a.val())}),customAmiiboList.forEach(function(a,b){markOwnershipCustom(a,b,authId)}),waitToFinish4()}else window.location.href="index.html";else if(0==page.localeCompare("signin.html")){if(a){var a=firebase.auth().currentUser;location.href="indexsignedin.html"}}else 0==page.localeCompare("signout.html")&&(a||(window.location.href="index.html"))});var valueCustom=null,numberOfAmiibo=0,fastNumberOfAmiibo=0;0!=page.localeCompare("index.html")&&0!=page.localeCompare("indexsignedin.html")&&page||(fastcharacters1.forEach(fastForEachFunction),waitToFinish2(),characters.forEach(forEachFunction),waitToFinish3());var uploaded=0,backToIndex=0,pictureCustomRef,pictureTime,downloadURL,number,name,origin,date,wave,exclusive,description,rarity,have,customCounter=0,customSoFar=0,loadingModal=document.getElementById("loadingModal"),signInButton=document.getElementById("signInButton"),signInModal=document.getElementById("signInModal"),signUpButton=document.getElementById("signUpButton"),signUpModal=document.getElementById("signUpModal"),signOutButton=document.getElementById("signOutButton"),signOutModal=document.getElementById("signOutModal"),addButton=document.getElementById("addButton"),addModal=document.getElementById("addModal");window.onclick=function(a){a.target==signInModal?signInModal.style.display="none":a.target==signUpModal?signUpModal.style.display="none":a.target==addModal?addModal.style.display="none":a.target==signOutModal&&(signOutModal.style.display="none")};